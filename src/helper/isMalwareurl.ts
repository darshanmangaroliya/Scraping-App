import axios from "axios";
import { GOOGLE_API_KEY } from "../config";

export const isMalwareurl = async(url:string):Promise<boolean>=>{
    const res = await axios.post(`https://safebrowsing.googleapis.com/v4/threatMatches:find?key=${import.meta.env.GOOGLE_API_KEY || GOOGLE_API_KEY}`, {
        "client": {
          "clientId": "myapp",
          "clientVersion": "1.0.0"
        },
        "threatInfo": {
          "threatTypes": ["MALWARE", "SOCIAL_ENGINEERING", "UNWANTED_SOFTWARE", "POTENTIALLY_HARMFUL_APPLICATION"],
          "platformTypes": ["ANY_PLATFORM"],
          "threatEntryTypes": ["URL"],
          "threatEntries": [{ "url": url }]
        }
      });

      return res.data.matches && res.data.matches.length > 0
}